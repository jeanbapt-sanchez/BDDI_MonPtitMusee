{"ast":null,"code":"import _slicedToArray from\"/Users/jeanbapt-sanchez/Documents/school/bddi-2020/gobelins-2020/Semaine-8-9/BDDI_MonPtitMusee/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import'./styles/SceneFusil.css';import Fusil from'../../assets/img/02_Fusil/fusil.gif';import FusilShoot from'../../assets/animations-vid/fusil-fleur-one-loop.gif';import LastFrameShoot from'../../assets/img/02_Fusil/last-frame-fusil.gif';import Tirer from'../../assets/gestures/geste_tirer.gif';import Etale from'../../assets/img/02_Fusil/etal-min.png';import Plan1 from'../../assets/img/02_Fusil/plan1-min.png';import Plan2 from'../../assets/img/02_Fusil/plan2-min.png';import Caisse from'../../assets/img/02_Fusil/plan3_caisse-min.png';import Pollen from'../../assets/animations-vid/pollen_envers.gif';import Scene21 from'../../assets/audio/scene2.1.mp3';import Scene22 from'../../assets/audio/scene2.2.mp3';import{useEffect,useRef,useState}from'react';import ZingTouch from'zingtouch';import{Redirect}from'react-router-dom';import Sound from\"../../assets/pictos/sound.svg\";import NoSound from\"../../assets/pictos/no-sound.svg\";var SceneFusil=function SceneFusil(props){var bodySceneFusilRef=useRef();var refRectangle=useRef();var fusilRef=useRef();var etaleRef=useRef();var plan1Ref=useRef();var plan2Ref=useRef();var caisseRef=useRef();var pollenRef=useRef();var force=0;var direction=0;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),indicationShooting=_useState2[0],setIndicationShooting=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),decorIsDisplay=_useState4[0],setDecorIsDisplay=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),pollenIsDisplay=_useState6[0],setPollenIsDisplay=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),redirect=_useState8[0],setRedirect=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isVoice=_useState10[0],setisVoice=_useState10[1];props.soundEffect.src=Scene21;var soundRef=useRef(null);// useEffect(() => {\n//         if(isVoice === true){\n//         setTimeout(() => {\n//             soundRef.current.src = Sound\n//             props.soundEffect.play()\n//         }, 1) \n//         } else {\n//             setTimeout(() => {\n//                 console.log(soundRef)\n//                 soundRef.current.src = NoSound\n//                 props.soundEffect.pause()\n//             }, 1)\n//         }\n//   }, [isVoice])\nvar callBackShoot=function callBackShoot(){setIndicationShooting(false);refRectangle.current.style.transform=\"translate(0%)\";if(force>240&&(direction<15||direction>350)){document.removeEventListener('touchend',callBackShoot,true);console.log('GIF DU FUSIL QUI TIRE');fusilRef.current.src=FusilShoot;var TEMPSGIFFUSIL=2500;props.soundEffect.src=Scene22;props.soundEffect.play();setTimeout(function(){console.log('Image de fin DU FUSIL QUI TIRE');bodySceneFusilRef.current.position='static';var intervalScene22=setInterval(function(){// TODO : Mettre le temps à 35 secondes\nif(props.soundEffect.currentTime>35){clearInterval(intervalScene22);setPollenIsDisplay(true);// TO DO : device motion pour suivre le pollen\nplan1Ref.current.style.transform='translateX(-600px)';plan2Ref.current.style.transform='translateX(600px)';caisseRef.current.style.transform='translateY(600px)';setTimeout(function(){setDecorIsDisplay(false);var handleOrientation=function handleOrientation(event){var beta=event.beta;// console.log(alpha, beta, gamma)\nconsole.log(beta);window.scroll(0,beta*15);if(beta>117){bodySceneFusilRef.current.style.opacity=0;setTimeout(function(){setRedirect('/experience/indoor/ar');},1000);}};window.addEventListener(\"deviceorientation\",handleOrientation,true);},800);}},100);},TEMPSGIFFUSIL);}};useEffect(function(){setTimeout(function(){bodySceneFusilRef.current.style.opacity=1;},1000);setTimeout(function(){fusilRef.current.style.opacity=1;etaleRef.current.style.opacity=1;plan1Ref.current.style.left='0';plan2Ref.current.style.right='0';caisseRef.current.style.bottom='66.6666%';},2000);},[]);useEffect(function(){if(isVoice===true){props.soundEffect.play();soundRef.current.src=Sound;var interval=setInterval(function(){console.log(props.soundEffect.currentTime);if(props.soundEffect.currentTime>7.5){// TODO : Lancer l'indication de gesture ainsi que l'opacité du BG\nbodySceneFusilRef.current.style.opacity=.5;setIndicationShooting(true);var zt=new ZingTouch.Region(bodySceneFusilRef.current);var pan=new ZingTouch.Pan({numInputs:1});zt.bind(bodySceneFusilRef.current,pan,function(e){e.preventDefault();bodySceneFusilRef.current.style.opacity=1;var data=e.detail.data[0];// console.log(e.detail.data)\nforce=data.distanceFromOrigin;direction=data.directionFromOrigin;console.log(force,direction);refRectangle.current.style.transform=\"translate(\".concat(force/10,\"%)\");refRectangle.current.style.borderRadius=\"\".concat(force,\"%\");},false);bodySceneFusilRef.current.addEventListener('touchend',callBackShoot,true);clearInterval(interval);}},100);}else{console.log('mute');soundRef.current.src=NoSound;props.soundEffect.pause();}},[isVoice]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"img\",{src:Sound,ref:soundRef,alt:\"sound\",onClick:function onClick(){setisVoice(!isVoice);},className:\"sound absolute left-5 top-4 w-10 z-80 cursor-pointer\"})}),indicationShooting&&/*#__PURE__*/_jsx(\"img\",{src:Tirer,alt:\"indication tirer\",className:\"absolute top-0 z-40\"}),/*#__PURE__*/_jsxs(\"div\",{ref:bodySceneFusilRef,className:\"body-sceneFusil w-full h-full absolute opacity-0 transition-opacity duration-700 ease-in-out\",children:[/*#__PURE__*/_jsx(\"img\",{ref:fusilRef,src:Fusil,alt:\"fusil\",className:\"fusil opacity-0 z-20\"}),/*#__PURE__*/_jsx(\"img\",{ref:etaleRef,src:Etale,className:\"bottom-2/3 opacity-0 z-10\",alt:\"plan1\"}),decorIsDisplay&&/*#__PURE__*/_jsx(\"img\",{ref:plan1Ref,src:Plan1,className:\"bottom-2/3 -left-full z-20\",alt:\"plan1\"}),decorIsDisplay&&/*#__PURE__*/_jsx(\"img\",{ref:plan2Ref,src:Plan2,className:\"bottom-2/3 -right-full z-10\",alt:\"plan2\"}),decorIsDisplay&&/*#__PURE__*/_jsx(\"img\",{ref:caisseRef,src:Caisse,className:\"-bottom-10\",alt:\"caisse\"}),pollenIsDisplay&&/*#__PURE__*/_jsx(\"img\",{ref:pollenRef,src:Pollen,className:\"pollen\",alt:\"pollen\"}),/*#__PURE__*/_jsx(\"div\",{ref:refRectangle,className:\"rectangle h-screen bg-grey w-1/3 bottom-O opacity-30\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-screen h-2/3 bottom-0 endPollen\"})]}),redirect&&/*#__PURE__*/_jsx(Redirect,{to:redirect})]});};export default SceneFusil;","map":{"version":3,"sources":["/Users/jeanbapt-sanchez/Documents/school/bddi-2020/gobelins-2020/Semaine-8-9/BDDI_MonPtitMusee/src/components/Scenes/SceneFusil.js"],"names":["Fusil","FusilShoot","LastFrameShoot","Tirer","Etale","Plan1","Plan2","Caisse","Pollen","Scene21","Scene22","useEffect","useRef","useState","ZingTouch","Redirect","SceneFusil","props","bodySceneFusilRef","refRectangle","fusilRef","etaleRef","plan1Ref","plan2Ref","caisseRef","pollenRef","force","direction","indicationShooting","setIndicationShooting","decorIsDisplay","setDecorIsDisplay","pollenIsDisplay","setPollenIsDisplay","redirect","setRedirect","isVoice","setisVoice","soundEffect","src","soundRef","callBackShoot","current","style","transform","document","removeEventListener","console","log","TEMPSGIFFUSIL","play","setTimeout","position","intervalScene22","setInterval","currentTime","clearInterval","handleOrientation","event","beta","window","scroll","opacity","addEventListener","left","right","bottom","Sound","interval","zt","Region","pan","Pan","numInputs","bind","e","preventDefault","data","detail","distanceFromOrigin","directionFromOrigin","borderRadius","NoSound","pause"],"mappings":"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","sourcesContent":["import './styles/SceneFusil.css'\nimport Fusil from '../../assets/img/02_Fusil/fusil.gif'\nimport FusilShoot from '../../assets/animations-vid/fusil-fleur-one-loop.gif'\nimport LastFrameShoot from '../../assets/img/02_Fusil/last-frame-fusil.gif'\nimport Tirer from '../../assets/gestures/geste_tirer.gif'\nimport Etale from '../../assets/img/02_Fusil/etal-min.png'\nimport Plan1 from '../../assets/img/02_Fusil/plan1-min.png'\nimport Plan2 from '../../assets/img/02_Fusil/plan2-min.png'\nimport Caisse from '../../assets/img/02_Fusil/plan3_caisse-min.png'\nimport Pollen from '../../assets/animations-vid/pollen_envers.gif'\nimport Scene21 from '../../assets/audio/scene2.1.mp3'\nimport Scene22 from '../../assets/audio/scene2.2.mp3'\nimport { useEffect, useRef, useState } from 'react'\nimport ZingTouch from 'zingtouch'\nimport { Redirect } from 'react-router-dom'\nimport Sound from '../../assets/pictos/sound.svg'\nimport NoSound from '../../assets/pictos/no-sound.svg'\n\nconst SceneFusil = (props) => {\n    let bodySceneFusilRef = useRef()\n    let refRectangle = useRef()\n    let fusilRef = useRef()\n    let etaleRef = useRef()\n    let plan1Ref = useRef()\n    let plan2Ref = useRef()\n    let caisseRef = useRef()\n    let pollenRef = useRef()\n    let force = 0\n    let direction = 0\n\n    let [indicationShooting, setIndicationShooting] = useState(false)\n    let [decorIsDisplay, setDecorIsDisplay] = useState(true)\n    let [pollenIsDisplay, setPollenIsDisplay] = useState(false)\n    let [redirect, setRedirect] = useState(null)\n    let [isVoice, setisVoice] = useState(false)\n\n    props.soundEffect.src = Scene21\n\n    const soundRef = useRef(null)\n\n    // useEffect(() => {\n \n    //         if(isVoice === true){\n    //         setTimeout(() => {\n    //             soundRef.current.src = Sound\n    //             props.soundEffect.play()\n    //         }, 1) \n    //         } else {\n    //             setTimeout(() => {\n    //                 console.log(soundRef)\n    //                 soundRef.current.src = NoSound\n    //                 props.soundEffect.pause()\n    //             }, 1)\n    //         }\n    //   }, [isVoice])\n\n    const callBackShoot = () => {\n        setIndicationShooting(false)\n        refRectangle.current.style.transform = `translate(0%)`\n\n        if(force > 240 && (direction < 15 || direction > 350)){\n            document.removeEventListener('touchend', callBackShoot, true)\n\n            console.log('GIF DU FUSIL QUI TIRE')\n            fusilRef.current.src = FusilShoot\n            const TEMPSGIFFUSIL = 2500\n            props.soundEffect.src = Scene22\n            props.soundEffect.play()\n            \n            setTimeout(() => {\n                console.log('Image de fin DU FUSIL QUI TIRE')\n                bodySceneFusilRef.current.position = 'static'\n                const intervalScene22 = setInterval(() => {\n                    // TODO : Mettre le temps à 35 secondes\n                    if(props.soundEffect.currentTime > 35){\n                        clearInterval(intervalScene22)\n                        setPollenIsDisplay(true)\n                        // TO DO : device motion pour suivre le pollen\n                        plan1Ref.current.style.transform = 'translateX(-600px)'\n                        plan2Ref.current.style.transform = 'translateX(600px)'\n                        caisseRef.current.style.transform = 'translateY(600px)'\n                        setTimeout(() => {\n                            setDecorIsDisplay(false)\n\n                            let handleOrientation = (event) => {\n                                let beta = event.beta;\n                                // console.log(alpha, beta, gamma)\n                                console.log(beta)\n                                window.scroll(0, (beta) * 15)\n                                if(beta > 117){\n                                    bodySceneFusilRef.current.style.opacity = 0\n                                    setTimeout(() => {\n                                        setRedirect('/experience/indoor/ar')\n                                    }, 1000)\n                                }\n                            }\n                            window.addEventListener(\"deviceorientation\", handleOrientation, true);\n                        }, 800)\n                    }\n                }, 100);\n            }, TEMPSGIFFUSIL)\n        }\n    }\n\n    useEffect(() => {\n        setTimeout(() =>{\n            bodySceneFusilRef.current.style.opacity = 1\n        }, 1000)\n        setTimeout(() => {\n            fusilRef.current.style.opacity = 1\n            etaleRef.current.style.opacity = 1\n            plan1Ref.current.style.left = '0'\n            plan2Ref.current.style.right = '0'\n            caisseRef.current.style.bottom = '66.6666%'\n        }, 2000)\n    }, [])\n\n    useEffect(() => {    \n\n        if(isVoice === true){\n            props.soundEffect.play()\n            soundRef.current.src = Sound\n\n            const interval = setInterval(() => {\n                console.log(props.soundEffect.currentTime)\n                if(props.soundEffect.currentTime > 7.5){\n                    // TODO : Lancer l'indication de gesture ainsi que l'opacité du BG\n                    bodySceneFusilRef.current.style.opacity = .5\n                    setIndicationShooting(true)\n                    let zt = new ZingTouch.Region(bodySceneFusilRef.current)\n    \n                    const pan = new ZingTouch.Pan({\n                        numInputs: 1\n                    })\n\n                    zt.bind(bodySceneFusilRef.current, pan, function(e){\n                        e.preventDefault()\n    \n                        bodySceneFusilRef.current.style.opacity = 1\n    \n                        let data = e.detail.data[0]\n                        // console.log(e.detail.data)\n                        force = data.distanceFromOrigin\n                        direction = data.directionFromOrigin\n                        console.log(force, direction)\n                        refRectangle.current.style.transform = `translate(${force / 10 }%)`\n                        refRectangle.current.style.borderRadius = `${force}%`\n                    }, false);\n                \n                    bodySceneFusilRef.current.addEventListener('touchend', callBackShoot, true)\n                    clearInterval(interval)\n                }\n            }, 100)\n        } else {\n            console.log('mute')\n            soundRef.current.src = NoSound\n            props.soundEffect.pause()\n        }\n    }, [isVoice])\n\n    return (\n        <div>\n            <p>\n            <img\n                src={Sound}\n                ref={soundRef}\n                alt=\"sound\"\n                onClick={() => {setisVoice(!isVoice)}}\n                className=\"sound absolute left-5 top-4 w-10 z-80 cursor-pointer\"/>\n            </p>\n            {indicationShooting && <img src={Tirer} alt=\"indication tirer\" className=\"absolute top-0 z-40\" />}\n            <div ref={bodySceneFusilRef} className=\"body-sceneFusil w-full h-full absolute opacity-0 transition-opacity duration-700 ease-in-out\">\n                <img ref={fusilRef} src={Fusil} alt=\"fusil\" className=\"fusil opacity-0 z-20\"></img>\n                <img ref={etaleRef} src={Etale} className=\"bottom-2/3 opacity-0 z-10\" alt=\"plan1\"/>\n                {decorIsDisplay && <img ref={plan1Ref} src={Plan1} className=\"bottom-2/3 -left-full z-20\" alt=\"plan1\"/>}\n                {decorIsDisplay && <img ref={plan2Ref} src={Plan2} className=\"bottom-2/3 -right-full z-10\" alt=\"plan2\"/>}\n                {decorIsDisplay && <img ref={caisseRef} src={Caisse} className=\"-bottom-10\" alt=\"caisse\"/>}\n                {pollenIsDisplay && <img ref={pollenRef} src={Pollen} className=\"pollen\" alt=\"pollen\"/>}\n                <div ref={refRectangle} className=\"rectangle h-screen bg-grey w-1/3 bottom-O opacity-30\"></div>\n                <div className=\"w-screen h-2/3 bottom-0 endPollen\"></div>\n            </div>\n            {redirect && <Redirect to={redirect} />}\n        </div>\n    )\n}\n\nexport default SceneFusil;\n"]},"metadata":{},"sourceType":"module"}