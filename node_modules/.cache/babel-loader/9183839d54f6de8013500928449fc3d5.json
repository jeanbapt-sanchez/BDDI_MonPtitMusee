{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/jeanbapt-sanchez/Documents/school/bddi-2020/gobelins-2020/Semaine-8-9/BDDI_ArtHouse/arthouse-app/src/components/Scenes/SceneLivre.js\",\n    _s = $RefreshSig$();\n\nimport Bg from '../../assets/img/01_Image/sol_et_fond.png';\nimport Armoire from '../../assets/img/01_Image/armoire.png';\nimport Flowers from '../../assets/img/01_Image/plan_horizontal.png';\nimport Table from '../../assets/img/01_Image/table.png';\nimport Cadre from \"../../assets/img/01_Image/cadre_photo.svg\";\nimport Visage from '../../assets/img/01_Image/visage-seul-1.gif';\nimport VisageParle from '../../assets/animations-vid/visage-one-loop.gif';\nimport Shake from '../../assets/gestures/geste_shake.gif';\nimport AudioS1 from '../../assets/audio/scene1.mp3';\nimport AudioS2 from '../../assets/audio/image_qui_parle.mp3';\nimport './styles/SceneLivre.css';\nimport { useEffect, useRef, useState } from 'react';\nimport Boussole from \"../../assets/gestures/boussole-02.svg\";\nimport FlecheBoussole from \"../../assets/gestures/boussole-03.svg\";\nimport { Redirect } from \"react-router-dom\";\n\nconst SceneLivre = props => {\n  _s();\n\n  let bodySceneLivre = useRef(null);\n  let armoirRef = useRef(null);\n  let fleursRef = useRef(null);\n  let tableRef = useRef(null);\n  let shakeRef = useRef(null);\n  let audioRef = useRef(null);\n  let audioRef2 = useRef(null);\n  let boussoleRef = useRef(null);\n  let flecheBoussoleRef = useRef(null);\n  let visageRef = useRef(null);\n  let cadreRef = useRef(null);\n  let [gestureIsDisplay, setGestureIsDisplay] = useState(false);\n  let [compassIsDisplay, setCompassIsDisplay] = useState(false);\n  let [redirect, setRedirect] = useState(null);\n  useEffect(() => {\n    setTimeout(() => {\n      bodySceneLivre.current.style.opacity = .5;\n      armoirRef.current.style.right = '0';\n      fleursRef.current.style.top = '25%';\n      tableRef.current.style.bottom = '7%';\n      cadreRef.current.style.bottom = '40%';\n    }, 1000); // TO DO : Implémenter le nombre de seconde de la durée de la première voix : TIMEOUT à 25000\n\n    setTimeout(() => {\n      setGestureIsDisplay(true);\n      shakeRef.current.style.opacity = 1;\n      runSecousse();\n    }, 2000); // window.addEventListener('scroll', noScroll);\n  }, []);\n  useEffect(() => {\n    // console.log('mon mute :', props.isVoice)\n    if (props.isVoice === true && audioRef.current.currentTime < 1) {\n      props.soundEffect.src = AudioS1; // props.soundEffect.play()\n    } // props.soundEffectplay()\n    // } else if (props.isVoice === false){\n    //     // console.log('stop ', props.soundEffect )\n    //     props.soundEffect.pause()\n    // } else if (props.isVoice === true && props.soundEffect.currentTime > 1){\n    //     // audioRef2.current.play()\n    // } else if (props.soundEffect.currentTime > 1){\n    //     props.soundEffect.pause()\n    //     // audioRef2.current.pause()\n    // }\n\n  }, [props.isVoice, props.soundEffect]);\n\n  const runSecousse = () => {\n    try {\n      window.addEventListener('devicemotion', callBackSecousse, true);\n    } catch (e) {\n      console.log('erreur', e);\n    }\n  };\n\n  const runBoussole = () => {\n    if (window.DeviceOrientationEvent) {\n      // Listen for the deviceorientation event and handle the raw data\n      window.addEventListener('deviceorientation', callBackBoussole, true);\n    }\n  };\n\n  let progressionFaceDisplaying = 0;\n\n  const callBackSecousse = event => {\n    console.log('callBackSecousse se lance');\n    console.log(progressionFaceDisplaying);\n\n    if (event.acceleration.y > 25) {\n      progressionFaceDisplaying++;\n      console.log(progressionFaceDisplaying);\n      visageRef.current.style.opacity = progressionFaceDisplaying / 10;\n    }\n\n    if (progressionFaceDisplaying >= 10) {\n      window.removeEventListener('devicemotion', callBackSecousse, true);\n      bodySceneLivre.current.style.opacity = 1;\n    } else if (progressionFaceDisplaying === 2) {\n      setGestureIsDisplay(false);\n    }\n  };\n\n  const callBackBoussole = event => {\n    let compassdir;\n\n    if (event.webkitCompassHeading) {\n      // Apple works only with this, alpha doesn't work\n      compassdir = event.webkitCompassHeading; // console.log(compassdir)\n    } else compassdir = event.alpha;\n\n    compassdir = -compassdir;\n    boussoleRef.current.style.transform = `rotate(${compassdir}deg)`; // console.log(boussole.style.transform)\n\n    if (-compassdir > 179 && -compassdir < 181) {\n      boussoleRef.current.style.opacity = 0;\n      flecheBoussoleRef.current.style.opacity = 0;\n      bodySceneLivre.current.style.opacity = 1;\n      window.removeEventListener('deviceorientation', callBackBoussole, true);\n      bodySceneLivre.current.style.opacity = 0;\n      setTimeout(() => {\n        setRedirect('/experience/indoor/scene/2');\n      }, 1000); // TODO : Déclencher l'animation \n\n      console.log('DECLENCHED ANINMATION');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full h-screen fixed\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: bodySceneLivre,\n      className: \"body w-full h-screen  overflow-x-hidden transition-opacity duration-700 ease-in-out\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: Bg,\n        alt: \"background\",\n        className: \"w-screen h-screen\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: armoirRef,\n        src: Armoire,\n        alt: \"armoire\",\n        className: \"z-1 w-5/12 -top-2 -right-40 transition duration-700 ease-in-out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: fleursRef,\n        src: Flowers,\n        alt: \"fleurs\",\n        className: \"fleurs -top-2/3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: tableRef,\n        src: Table,\n        alt: \"table\",\n        className: \"z-10 -bottom-80\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: Cadre,\n        ref: cadreRef,\n        alt: \"cadre\",\n        className: \"cadre w-1/2 z-10 left-1/4 -bottom-80\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: Visage,\n        ref: visageRef,\n        onClick: () => {\n          visageRef.current.src = VisageParle;\n          props.soundEffect.src = AudioS2;\n          console.log('play');\n          props.soundEffect.play(); // TO DO : Lancer le son et l'animation du visage\n\n          const interval = setInterval(() => {\n            if (props.soundEffect.currentTime > 14.5) {\n              setTimeout(() => {\n                setCompassIsDisplay(true);\n                console.log('boussole ok');\n                console.log(compassIsDisplay);\n                bodySceneLivre.current.style.opacity = .5;\n                boussoleRef.current.style.opacity = 1;\n                flecheBoussoleRef.current.style.opacity = 1;\n                runBoussole();\n              }, 1000);\n              clearInterval(interval);\n            }\n          }, 500);\n        },\n        alt: \"visage\",\n        className: \"visage mb-10 z-10 bottom-60 left-1/4 opacity-0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        ref: audioRef,\n        src: AudioS1,\n        children: [\"Your browser does not support the\", /*#__PURE__*/_jsxDEV(\"code\", {\n          children: \"audio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 25\n        }, this), \" element.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        ref: audioRef2,\n        src: AudioS2,\n        children: [\"Your browser does not support the\", /*#__PURE__*/_jsxDEV(\"code\", {\n          children: \"audio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }, this), \" element.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }, this), gestureIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n      ref: shakeRef,\n      src: Shake,\n      alt: \"shake\",\n      className: \"anim absolute top-0 opacity-0 z-50\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 34\n    }, this), compassIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n      ref: boussoleRef,\n      src: Boussole,\n      className: \"w-40 absolute transform left-1/3  top-1/3 opacity-0 transition-opacity duration-500 ease-in-out\",\n      alt: \"fleche boussole\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 34\n    }, this), compassIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n      ref: flecheBoussoleRef,\n      src: FlecheBoussole,\n      className: \"w-20 absolute left-1/3 ml-10 mb-2 transform rotate-180 top-1/4 opacity-0 transition-opacity duration-500 ease-in-out\",\n      alt: \"fleche boussole\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 34\n    }, this), redirect && /*#__PURE__*/_jsxDEV(Redirect, {\n      to: redirect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 26\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 9\n  }, this);\n};\n\n_s(SceneLivre, \"G4XZy6coeSTdtVuca+SP3rDMeg8=\");\n\n_c = SceneLivre;\nexport default SceneLivre;\n\nvar _c;\n\n$RefreshReg$(_c, \"SceneLivre\");","map":{"version":3,"sources":["/Users/jeanbapt-sanchez/Documents/school/bddi-2020/gobelins-2020/Semaine-8-9/BDDI_ArtHouse/arthouse-app/src/components/Scenes/SceneLivre.js"],"names":["Bg","Armoire","Flowers","Table","Visage","VisageParle","Shake","AudioS1","AudioS2","useEffect","useRef","useState","Redirect","SceneLivre","props","bodySceneLivre","armoirRef","fleursRef","tableRef","shakeRef","audioRef","audioRef2","boussoleRef","flecheBoussoleRef","visageRef","cadreRef","gestureIsDisplay","setGestureIsDisplay","compassIsDisplay","setCompassIsDisplay","redirect","setRedirect","setTimeout","current","style","opacity","right","top","bottom","runSecousse","isVoice","currentTime","soundEffect","src","window","addEventListener","callBackSecousse","e","console","log","runBoussole","DeviceOrientationEvent","callBackBoussole","progressionFaceDisplaying","event","acceleration","y","removeEventListener","compassdir","webkitCompassHeading","alpha","transform","Cadre","play","interval","setInterval","clearInterval","Boussole","FlecheBoussole"],"mappings":"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","sourcesContent":["import Bg from '../../assets/img/01_Image/sol_et_fond.png'\nimport Armoire from '../../assets/img/01_Image/armoire.png'\nimport Flowers from '../../assets/img/01_Image/plan_horizontal.png'\nimport Table from '../../assets/img/01_Image/table.png'\nimport Cadre from '../../assets/img/01_Image/cadre_photo.svg'\nimport Visage from '../../assets/img/01_Image/visage-seul-1.gif'\nimport VisageParle from '../../assets/animations-vid/visage-one-loop.gif'\nimport Shake from '../../assets/gestures/geste_shake.gif'\nimport AudioS1 from '../../assets/audio/scene1.mp3'\nimport AudioS2 from '../../assets/audio/image_qui_parle.mp3'\nimport './styles/SceneLivre.css'\nimport { useEffect, useRef, useState } from 'react'\nimport Boussole from '../../assets/gestures/boussole-02.svg'\nimport FlecheBoussole from '../../assets/gestures/boussole-03.svg'\nimport { Redirect } from \"react-router-dom\";\n\nconst SceneLivre = (props) => {\n    let bodySceneLivre = useRef(null)\n    let armoirRef = useRef(null)\n    let fleursRef = useRef(null)\n    let tableRef = useRef(null)\n    let shakeRef = useRef(null)\n    let audioRef = useRef(null)\n    let audioRef2 = useRef(null)\n    let boussoleRef = useRef(null)\n    let flecheBoussoleRef = useRef(null)\n    let visageRef = useRef(null)\n    let cadreRef = useRef(null)\n\n    let [gestureIsDisplay, setGestureIsDisplay] = useState(false)\n    let [compassIsDisplay, setCompassIsDisplay] = useState(false)\n    let [redirect, setRedirect] = useState(null)\n\n    useEffect(() => {\n        setTimeout(() => {\n            bodySceneLivre.current.style.opacity = .5\n            armoirRef.current.style.right = '0'\n            fleursRef.current.style.top = '25%'\n            tableRef.current.style.bottom = '7%'\n            cadreRef.current.style.bottom = '40%'\n        }, 1000)\n        \n        // TO DO : Implémenter le nombre de seconde de la durée de la première voix : TIMEOUT à 25000\n        setTimeout(() => {\n            setGestureIsDisplay(true)\n            shakeRef.current.style.opacity = 1\n            runSecousse()\n        }, 2000)\n        // window.addEventListener('scroll', noScroll);\n    }, [])\n\n    useEffect(() => {\n        // console.log('mon mute :', props.isVoice)\n        if(props.isVoice === true && audioRef.current.currentTime < 1){\n            props.soundEffect.src = AudioS1\n            // props.soundEffect.play()\n        }\n\n        // props.soundEffectplay()\n        // } else if (props.isVoice === false){\n        //     // console.log('stop ', props.soundEffect )\n        //     props.soundEffect.pause()\n        // } else if (props.isVoice === true && props.soundEffect.currentTime > 1){\n        //     // audioRef2.current.play()\n        // } else if (props.soundEffect.currentTime > 1){\n        //     props.soundEffect.pause()\n        //     // audioRef2.current.pause()\n        // }\n    }, [props.isVoice, props.soundEffect])\n\n    const runSecousse = () => {\n        try{\n            window.addEventListener('devicemotion', callBackSecousse, true);\n        } catch (e){\n            console.log('erreur', e)\n        }\n    }\n\n    const runBoussole = () => {\n        if (window.DeviceOrientationEvent) {\n            // Listen for the deviceorientation event and handle the raw data\n            window.addEventListener('deviceorientation', callBackBoussole, true);\n        }\n    }\n\n    let progressionFaceDisplaying = 0\n    const callBackSecousse = (event) => {\n        console.log('callBackSecousse se lance')\n            console.log(progressionFaceDisplaying)\n            if(event.acceleration.y > 25){\n                progressionFaceDisplaying++\n                console.log(progressionFaceDisplaying)\n\n                visageRef.current.style.opacity = progressionFaceDisplaying / 10\n            }\n            if(progressionFaceDisplaying >= 10){\n                window.removeEventListener('devicemotion', callBackSecousse, true)\n                bodySceneLivre.current.style.opacity = 1\n\n            } else if (progressionFaceDisplaying === 2){\n                setGestureIsDisplay(false)\n            }\n    }\n\n    const callBackBoussole = (event) => {\n            let compassdir;\n\n            if(event.webkitCompassHeading) {\n                // Apple works only with this, alpha doesn't work\n                compassdir = event.webkitCompassHeading;  \n                // console.log(compassdir)\n            }\n            else compassdir = event.alpha;\n\n            compassdir = -compassdir\n            boussoleRef.current.style.transform = `rotate(${compassdir}deg)`\n            // console.log(boussole.style.transform)\n            if(-compassdir > 179 && -compassdir < 181){\n                boussoleRef.current.style.opacity = 0\n                flecheBoussoleRef.current.style.opacity = 0\n                bodySceneLivre.current.style.opacity = 1\n                window.removeEventListener('deviceorientation', callBackBoussole, true)\n                bodySceneLivre.current.style.opacity = 0\n                setTimeout(() => {\n                    setRedirect('/experience/indoor/scene/2')\n                }, 1000)\n                // TODO : Déclencher l'animation \n                console.log('DECLENCHED ANINMATION')\n            }\n        }\n\n    return(\n        <div className=\"w-full h-screen fixed\">\n            <div ref={bodySceneLivre} className=\"body w-full h-screen  overflow-x-hidden transition-opacity duration-700 ease-in-out\">\n                <img src={Bg} alt=\"background\" className=\"w-screen h-screen\"/>\n                <img ref={armoirRef} src={Armoire} alt=\"armoire\" className=\"z-1 w-5/12 -top-2 -right-40 transition duration-700 ease-in-out\"></img>\n                <img ref={fleursRef} src={Flowers} alt=\"fleurs\" className=\"fleurs -top-2/3\"/>\n                <img ref={tableRef} src={Table} alt=\"table\" className=\"z-10 -bottom-80\"/>\n                <img src={Cadre} ref={cadreRef} alt=\"cadre\" className=\"cadre w-1/2 z-10 left-1/4 -bottom-80\"/>\n                <img src={Visage} ref={visageRef} onClick={() => {\n                    visageRef.current.src = VisageParle\n                    props.soundEffect.src = AudioS2\n                    console.log('play')\n                    props.soundEffect.play()\n                    // TO DO : Lancer le son et l'animation du visage\n\n                    const interval = setInterval(() => {\n                        if(props.soundEffect.currentTime > 14.5){\n                            setTimeout(() => {\n                                setCompassIsDisplay(true)\n                                console.log('boussole ok')\n                                console.log(compassIsDisplay)\n                                bodySceneLivre.current.style.opacity = .5\n                                boussoleRef.current.style.opacity = 1\n                                flecheBoussoleRef.current.style.opacity = 1\n                                runBoussole()\n                            }, 1000)\n                            clearInterval(interval)\n                        }\n                    }, 500)\n                }} alt=\"visage\" className=\"visage mb-10 z-10 bottom-60 left-1/4 opacity-0\"/>\n                {/* <img src={Cadre} alt=\"Cadre Obey\" className=\"bottom-0 z-10\"/> */}\n\n                <audio ref={audioRef}\n                    src={AudioS1}>\n                        Your browser does not support the\n                        <code>audio</code> element.\n                </audio>\n                <audio ref={audioRef2}\n                    src={AudioS2}>\n                        Your browser does not support the\n                        <code>audio</code> element.\n                </audio>\n\n            </div>\n            {/* <button className=\"bottom-0 disa absolute\" onClick={() => {\n                    setProgressionFaceDisplaying(10)\n                    // Là je lance dans x secondes l'indication gesture qu'il faut tourner son téléphone vers le su\n\n                    audioRef2.current.play()\n                }\n                    }>Quitter le shake</button> */}\n            {gestureIsDisplay && <img ref={shakeRef} src={Shake} alt=\"shake\" className=\"anim absolute top-0 opacity-0 z-50\"/>}\n            {compassIsDisplay && <img ref={boussoleRef} src={Boussole} className=\"w-40 absolute transform left-1/3  top-1/3 opacity-0 transition-opacity duration-500 ease-in-out\" alt=\"fleche boussole\" />}\n            {compassIsDisplay && <img ref={flecheBoussoleRef} src={FlecheBoussole} className=\"w-20 absolute left-1/3 ml-10 mb-2 transform rotate-180 top-1/4 opacity-0 transition-opacity duration-500 ease-in-out\" alt=\"fleche boussole\" />}\n\n            {redirect && <Redirect to={redirect} />}\n        </div>\n        \n    )\n}\n\nexport default SceneLivre;\n"]},"metadata":{},"sourceType":"module"}