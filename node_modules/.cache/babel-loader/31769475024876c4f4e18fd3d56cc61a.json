{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/jeanbapt-sanchez/Documents/school/bddi-2020/gobelins-2020/Semaine-8-9/BDDI_ArtHouse/arthouse-app/src/components/Scenes/SceneFusil.js\",\n    _s = $RefreshSig$();\n\nimport './styles/SceneFusil.css';\nimport Fusil from '../../assets/img/02_Fusil/fusil.gif';\nimport FusilShoot from '../../assets/animations-vid/fusil-fleur-one-loop.gif';\nimport LastFrameShoot from '../../assets/img/02_Fusil/last-frame-fusil.gif';\nimport Tirer from '../../assets/gestures/geste_tirer.gif';\nimport Etale from '../../assets/img/02_Fusil/etal-min.png';\nimport Plan1 from '../../assets/img/02_Fusil/plan1-min.png';\nimport Plan2 from '../../assets/img/02_Fusil/plan2-min.png';\nimport Caisse from '../../assets/img/02_Fusil/plan3_caisse-min.png';\nimport Pollen from '../../assets/animations-vid/pollen_envers.gif';\nimport Scene21 from '../../assets/audio/scene2.1.mp3';\nimport Scene22 from '../../assets/audio/scene2.2.mp3';\nimport { useEffect, useRef, useState } from 'react';\nimport ZingTouch from 'zingtouch';\nimport { Redirect } from 'react-router-dom';\nimport Sound from \"../../assets/pictos/sound.svg\";\nimport NoSound from \"../../assets/pictos/no-sound.svg\";\n\nconst SceneFusil = props => {\n  _s();\n\n  let bodySceneFusilRef = useRef();\n  let refRectangle = useRef();\n  let fusilRef = useRef();\n  let etaleRef = useRef();\n  let plan1Ref = useRef();\n  let plan2Ref = useRef();\n  let caisseRef = useRef();\n  let pollenRef = useRef();\n  let force = 0;\n  let direction = 0;\n  let [indicationShooting, setIndicationShooting] = useState(false);\n  let [decorIsDisplay, setDecorIsDisplay] = useState(true);\n  let [pollenIsDisplay, setPollenIsDisplay] = useState(false);\n  let [redirect, setRedirect] = useState(null);\n  props.soundEffect.src = Scene21;\n  const soundRef = useRef(null);\n  useEffect(history => {\n    if (soundNotAccepted === false) {\n      setIsDesktop(false);\n\n      if (isVoice === true) {\n        setTimeout(() => {\n          soundRef.current.src = Sound; // soundEffect.play()\n        }, 1);\n      } else {\n        setTimeout(() => {\n          console.log(soundRef);\n          soundRef.current.src = NoSound; // soundEffect.pause()\n        }, 1);\n      }\n    }\n  }, [screenWidth, isVoice, soundNotAccepted]);\n\n  const callBackShoot = () => {\n    setIndicationShooting(false);\n    refRectangle.current.style.transform = `translate(0%)`;\n\n    if (force > 240 && (direction < 15 || direction > 350)) {\n      document.removeEventListener('touchend', callBackShoot, true);\n      console.log('GIF DU FUSIL QUI TIRE');\n      fusilRef.current.src = FusilShoot;\n      const TEMPSGIFFUSIL = 2500;\n      props.soundEffect.src = Scene22;\n      props.soundEffect.play();\n      setTimeout(() => {\n        console.log('Image de fin DU FUSIL QUI TIRE');\n        bodySceneFusilRef.current.position = 'static';\n        const intervalScene22 = setInterval(() => {\n          // TODO : Mettre le temps à 35 secondes\n          if (props.soundEffect.currentTime > 5) {\n            clearInterval(intervalScene22);\n            setPollenIsDisplay(true); // TO DO : device motion pour suivre le pollen\n\n            plan1Ref.current.style.transform = 'translateX(-600px)';\n            plan2Ref.current.style.transform = 'translateX(600px)';\n            caisseRef.current.style.transform = 'translateY(600px)';\n            setTimeout(() => {\n              setDecorIsDisplay(false);\n\n              let handleOrientation = event => {\n                let beta = event.beta; // console.log(alpha, beta, gamma)\n\n                console.log(beta);\n                window.scroll(0, beta * 15);\n\n                if (beta > 117) {\n                  bodySceneFusilRef.current.style.opacity = 0;\n                  setTimeout(() => {\n                    setRedirect('/experience/indoor/ar');\n                  }, 1000);\n                }\n              };\n\n              window.addEventListener(\"deviceorientation\", handleOrientation, true);\n            }, 800);\n          }\n        }, 100);\n      }, TEMPSGIFFUSIL);\n    }\n  };\n\n  useEffect(() => {\n    setTimeout(() => {\n      bodySceneFusilRef.current.style.opacity = 1;\n    }, 1000);\n    setTimeout(() => {\n      fusilRef.current.style.opacity = 1;\n      etaleRef.current.style.opacity = 1;\n      plan1Ref.current.style.left = '0';\n      plan2Ref.current.style.right = '0';\n      caisseRef.current.style.bottom = '66.6666%';\n    }, 2000);\n  }, []);\n  useEffect(() => {\n    if (props.isVoice === true) {\n      props.soundEffect.play();\n      const interval = setInterval(() => {\n        console.log(props.soundEffect.currentTime);\n\n        if (props.soundEffect.currentTime > 7.5) {\n          // TODO : Lancer l'indication de gesture ainsi que l'opacité du BG\n          bodySceneFusilRef.current.style.opacity = .5;\n          setIndicationShooting(true);\n          let zt = new ZingTouch.Region(bodySceneFusilRef.current);\n          const pan = new ZingTouch.Pan({\n            numInputs: 1\n          });\n          zt.bind(bodySceneFusilRef.current, pan, function (e) {\n            e.preventDefault();\n            bodySceneFusilRef.current.style.opacity = 1;\n            let data = e.detail.data[0]; // console.log(e.detail.data)\n\n            force = data.distanceFromOrigin;\n            direction = data.directionFromOrigin;\n            console.log(force, direction);\n            refRectangle.current.style.transform = `translate(${force / 10}%)`;\n            refRectangle.current.style.borderRadius = `${force}%`;\n          }, false);\n          bodySceneFusilRef.current.addEventListener('touchend', callBackShoot, true);\n          clearInterval(interval);\n        }\n      }, 100);\n    } else {\n      console.log('mute');\n      props.soundEffect.muted = true;\n    }\n  }, [props.isVoice]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: Sound,\n        ref: soundRef,\n        alt: \"sound\",\n        onClick: () => {\n          setisVoice(!isVoice);\n        },\n        className: \"sound absolute left-5 top-4 w-10 z-80 cursor-pointer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }, this), indicationShooting && /*#__PURE__*/_jsxDEV(\"img\", {\n      src: Tirer,\n      alt: \"indication tirer\",\n      className: \"absolute top-0 z-40\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 36\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: bodySceneFusilRef,\n      className: \"body-sceneFusil w-full h-full absolute opacity-0 transition-opacity duration-700 ease-in-out\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        ref: fusilRef,\n        src: Fusil,\n        alt: \"fusil\",\n        className: \"fusil opacity-0 z-20\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: etaleRef,\n        src: Etale,\n        className: \"bottom-2/3 opacity-0 z-10\",\n        alt: \"plan1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this), decorIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: plan1Ref,\n        src: Plan1,\n        className: \"bottom-2/3 -left-full z-20\",\n        alt: \"plan1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 36\n      }, this), decorIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: plan2Ref,\n        src: Plan2,\n        className: \"bottom-2/3 -right-full z-10\",\n        alt: \"plan2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 36\n      }, this), decorIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: caisseRef,\n        src: Caisse,\n        className: \"-bottom-10\",\n        alt: \"caisse\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 36\n      }, this), pollenIsDisplay && /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: pollenRef,\n        src: Pollen,\n        className: \"pollen\",\n        alt: \"pollen\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 37\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: refRectangle,\n        className: \"rectangle h-screen bg-grey w-1/3 bottom-O opacity-30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-screen h-2/3 bottom-0 endPollen\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }, this), redirect && /*#__PURE__*/_jsxDEV(Redirect, {\n      to: redirect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 26\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 159,\n    columnNumber: 9\n  }, this);\n};\n\n_s(SceneFusil, \"Uk5CCyW3YG8dzbHuQ/3ZdVO+Hp0=\");\n\n_c = SceneFusil;\nexport default SceneFusil;\n\nvar _c;\n\n$RefreshReg$(_c, \"SceneFusil\");","map":{"version":3,"sources":["/Users/jeanbapt-sanchez/Documents/school/bddi-2020/gobelins-2020/Semaine-8-9/BDDI_ArtHouse/arthouse-app/src/components/Scenes/SceneFusil.js"],"names":["Fusil","FusilShoot","LastFrameShoot","Tirer","Etale","Plan1","Plan2","Caisse","Pollen","Scene21","Scene22","useEffect","useRef","useState","ZingTouch","Redirect","SceneFusil","props","bodySceneFusilRef","refRectangle","fusilRef","etaleRef","plan1Ref","plan2Ref","caisseRef","pollenRef","force","direction","indicationShooting","setIndicationShooting","decorIsDisplay","setDecorIsDisplay","pollenIsDisplay","setPollenIsDisplay","redirect","setRedirect","soundEffect","src","soundRef","history","soundNotAccepted","setIsDesktop","isVoice","setTimeout","current","Sound","console","log","NoSound","screenWidth","callBackShoot","style","transform","document","removeEventListener","TEMPSGIFFUSIL","play","position","intervalScene22","setInterval","currentTime","clearInterval","handleOrientation","event","beta","window","scroll","opacity","addEventListener","left","right","bottom","interval","zt","Region","pan","Pan","numInputs","bind","e","preventDefault","data","detail","distanceFromOrigin","directionFromOrigin","borderRadius","muted","setisVoice"],"mappings":"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","sourcesContent":["import './styles/SceneFusil.css'\nimport Fusil from '../../assets/img/02_Fusil/fusil.gif'\nimport FusilShoot from '../../assets/animations-vid/fusil-fleur-one-loop.gif'\nimport LastFrameShoot from '../../assets/img/02_Fusil/last-frame-fusil.gif'\nimport Tirer from '../../assets/gestures/geste_tirer.gif'\nimport Etale from '../../assets/img/02_Fusil/etal-min.png'\nimport Plan1 from '../../assets/img/02_Fusil/plan1-min.png'\nimport Plan2 from '../../assets/img/02_Fusil/plan2-min.png'\nimport Caisse from '../../assets/img/02_Fusil/plan3_caisse-min.png'\nimport Pollen from '../../assets/animations-vid/pollen_envers.gif'\nimport Scene21 from '../../assets/audio/scene2.1.mp3'\nimport Scene22 from '../../assets/audio/scene2.2.mp3'\nimport { useEffect, useRef, useState } from 'react'\nimport ZingTouch from 'zingtouch'\nimport { Redirect } from 'react-router-dom'\nimport Sound from '../../assets/pictos/sound.svg'\nimport NoSound from '../../assets/pictos/no-sound.svg'\n\nconst SceneFusil = (props) => {\n    let bodySceneFusilRef = useRef()\n    let refRectangle = useRef()\n    let fusilRef = useRef()\n    let etaleRef = useRef()\n    let plan1Ref = useRef()\n    let plan2Ref = useRef()\n    let caisseRef = useRef()\n    let pollenRef = useRef()\n    let force = 0\n    let direction = 0\n\n    let [indicationShooting, setIndicationShooting] = useState(false)\n    let [decorIsDisplay, setDecorIsDisplay] = useState(true)\n    let [pollenIsDisplay, setPollenIsDisplay] = useState(false)\n    let [redirect, setRedirect] = useState(null)\n    props.soundEffect.src = Scene21\n\n    const soundRef = useRef(null)\n\n    useEffect((history) => {\n        if(soundNotAccepted === false){\n            setIsDesktop(false)\n            if(isVoice === true){\n            setTimeout(() => {\n                soundRef.current.src = Sound\n                // soundEffect.play()\n            }, 1) \n            } else {\n                setTimeout(() => {\n                    console.log(soundRef)\n                    soundRef.current.src = NoSound\n                    // soundEffect.pause()\n                }, 1)\n            }\n        }\n      }, [screenWidth, isVoice, soundNotAccepted])\n\n    const callBackShoot = () => {\n        setIndicationShooting(false)\n        refRectangle.current.style.transform = `translate(0%)`\n\n        if(force > 240 && (direction < 15 || direction > 350)){\n            document.removeEventListener('touchend', callBackShoot, true)\n\n            console.log('GIF DU FUSIL QUI TIRE')\n            fusilRef.current.src = FusilShoot\n            const TEMPSGIFFUSIL = 2500\n            props.soundEffect.src = Scene22\n            props.soundEffect.play()\n            \n            setTimeout(() => {\n                console.log('Image de fin DU FUSIL QUI TIRE')\n                bodySceneFusilRef.current.position = 'static'\n                const intervalScene22 = setInterval(() => {\n                    // TODO : Mettre le temps à 35 secondes\n                    if(props.soundEffect.currentTime > 5){\n                        clearInterval(intervalScene22)\n                        setPollenIsDisplay(true)\n                        // TO DO : device motion pour suivre le pollen\n                        plan1Ref.current.style.transform = 'translateX(-600px)'\n                        plan2Ref.current.style.transform = 'translateX(600px)'\n                        caisseRef.current.style.transform = 'translateY(600px)'\n                        setTimeout(() => {\n                            setDecorIsDisplay(false)\n\n                            let handleOrientation = (event) => {\n                                let beta = event.beta;\n                                // console.log(alpha, beta, gamma)\n                                console.log(beta)\n                                window.scroll(0, (beta) * 15)\n                                if(beta > 117){\n                                    bodySceneFusilRef.current.style.opacity = 0\n                                    setTimeout(() => {\n                                        setRedirect('/experience/indoor/ar')\n                                    }, 1000)\n                                }\n                            }\n                            window.addEventListener(\"deviceorientation\", handleOrientation, true);\n                        }, 800)\n                    }\n                }, 100);\n            }, TEMPSGIFFUSIL)\n        }\n    }\n\n    useEffect(() => {\n        setTimeout(() =>{\n            bodySceneFusilRef.current.style.opacity = 1\n        }, 1000)\n        setTimeout(() => {\n            fusilRef.current.style.opacity = 1\n            etaleRef.current.style.opacity = 1\n            plan1Ref.current.style.left = '0'\n            plan2Ref.current.style.right = '0'\n            caisseRef.current.style.bottom = '66.6666%'\n        }, 2000)\n    }, [])\n\n    useEffect(() => {    \n\n        if(props.isVoice === true){\n            props.soundEffect.play()\n            const interval = setInterval(() => {\n                console.log(props.soundEffect.currentTime)\n                if(props.soundEffect.currentTime > 7.5){\n                    // TODO : Lancer l'indication de gesture ainsi que l'opacité du BG\n                    bodySceneFusilRef.current.style.opacity = .5\n                    setIndicationShooting(true)\n                    let zt = new ZingTouch.Region(bodySceneFusilRef.current)\n    \n                    const pan = new ZingTouch.Pan({\n                        numInputs: 1\n                    })\n\n                    zt.bind(bodySceneFusilRef.current, pan, function(e){\n                        e.preventDefault()\n    \n                        bodySceneFusilRef.current.style.opacity = 1\n    \n                        let data = e.detail.data[0]\n                        // console.log(e.detail.data)\n                        force = data.distanceFromOrigin\n                        direction = data.directionFromOrigin\n                        console.log(force, direction)\n                        refRectangle.current.style.transform = `translate(${force / 10 }%)`\n                        refRectangle.current.style.borderRadius = `${force}%`\n                    }, false);\n                \n                    bodySceneFusilRef.current.addEventListener('touchend', callBackShoot, true)\n                    clearInterval(interval)\n                }\n            }, 100)\n        } else {\n            console.log('mute')\n            props.soundEffect.muted = true\n        }\n    }, [props.isVoice])\n\n    return (\n        <div>\n            <p>\n            <img\n                src={Sound}\n                ref={soundRef}\n                alt=\"sound\"\n                onClick={() => {setisVoice(!isVoice)}}\n                className=\"sound absolute left-5 top-4 w-10 z-80 cursor-pointer\"/>\n            </p>\n            {indicationShooting && <img src={Tirer} alt=\"indication tirer\" className=\"absolute top-0 z-40\" />}\n            <div ref={bodySceneFusilRef} className=\"body-sceneFusil w-full h-full absolute opacity-0 transition-opacity duration-700 ease-in-out\">\n                <img ref={fusilRef} src={Fusil} alt=\"fusil\" className=\"fusil opacity-0 z-20\"></img>\n                <img ref={etaleRef} src={Etale} className=\"bottom-2/3 opacity-0 z-10\" alt=\"plan1\"/>\n                {decorIsDisplay && <img ref={plan1Ref} src={Plan1} className=\"bottom-2/3 -left-full z-20\" alt=\"plan1\"/>}\n                {decorIsDisplay && <img ref={plan2Ref} src={Plan2} className=\"bottom-2/3 -right-full z-10\" alt=\"plan2\"/>}\n                {decorIsDisplay && <img ref={caisseRef} src={Caisse} className=\"-bottom-10\" alt=\"caisse\"/>}\n                {pollenIsDisplay && <img ref={pollenRef} src={Pollen} className=\"pollen\" alt=\"pollen\"/>}\n                <div ref={refRectangle} className=\"rectangle h-screen bg-grey w-1/3 bottom-O opacity-30\"></div>\n                <div className=\"w-screen h-2/3 bottom-0 endPollen\"></div>\n            </div>\n            {redirect && <Redirect to={redirect} />}\n        </div>\n    )\n}\n\nexport default SceneFusil;\n"]},"metadata":{},"sourceType":"module"}